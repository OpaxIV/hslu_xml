<?xml version="1.0" ?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns="http://www.w3.org/1999/xhtml">
    <xsl:output doctype-public="-//W3C//DTD XHTML 1.0 Strict//EN"
                doctype-system="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"/>

    <xsl:template match="bond_movies">
        <html>
            <head>
                <title>James Bond Movie Catalogue</title>
            </head>
            <body>

                <!-- Title and subtitles  -->

                <h1>James Bond Movie Catalog</h1>
                <div>
                    <i>This is a list of all James Bond movies between 1962 and <xsl:value-of select="@year"/>.
                    </i>
                    <br/>
                    <br/>
                    <b>Movies with Sean Connery as main character in alphabetical order (by title):</b>
                    <br/>
                    <br/>
                </div>

                <table border="1" cellpadding="10'">

                    <!-- Table header  -->

                    <tr style="background-color:#990066">
                        <th>Title</th>
                        <th>Bond Actor</th>
                        <th>Bond Girl</th>
                        <th>Producer</th>
                        <th>Year</th>
                        <th>Length</th>
                    </tr>

                    <!-- Add only movies from Sean Connery (sorted by title) -->

                    <xsl:apply-templates select="movie[starts-with(bond/text(), 'Sean')]">
                        <xsl:sort select="title" data-type="text"/>
                    </xsl:apply-templates>

                </table>

                <!-- Title and subtitle -->

                <div>
                    <br/>
                    <br/>
                    <b>Movies with Roger Moore as main character in numerical order (by year):</b>
                    <br/>
                    <br/>
                </div>

                <table border="1" cellpadding="10'">

                    <!-- Table header -->

                    <tr style="background-color:#6666FF">
                        <th>Title</th>
                        <th>Bond Actor</th>
                        <th>Bond Girl</th>
                        <th>Producer</th>
                        <th>Year</th>
                        <th>Length</th>
                    </tr>

                    <!-- Add only movies from Roger Moore (sorted by year) -->

                    <xsl:apply-templates select="movie[starts-with(bond/text(), 'Roger')]">
                        <xsl:sort select="Year" data-type="number"/>
                    </xsl:apply-templates>

                </table>



















                <!-- Title and subtitle -->

                <div>
                    <br/>
                    <br/>
                    <b>Movies with Timothy Dalton as main character in numerical order (by duration):</b>
                    <br/>
                    <br/>
                </div>

                <table border="1" cellpadding="10'">

                    <!-- Table header-->

                    <tr style="background-color:#9acd32">
                        <th>Title</th>
                        <th>Bond Actor</th>
                        <th>Bond Girl</th>
                        <th>Producer</th>
                        <th>Year</th>
                        <th>Length</th>
                    </tr>

                    <!-- Add only movies from Timothy Dalton (sorted by duration) -->

                    <xsl:apply-templates select="movie[starts-with(bond/text(), 'Tim')]">
                        <xsl:sort select="duration" data-type="number"/>
                    </xsl:apply-templates>

                </table>

                <!-- Title and subtitle -->

                <div>
                    <br/>
                    <br/>
                    <b>Movies with Pierce Brosnan as main character in alphabetical order (by name of Bond girl in
                        descending order):
                    </b>
                    <br/>
                    <br/>
                </div>

                <table border="1" cellpadding="10'">

                    <!-- Table header -->

                    <tr style="background-color:#CC66FF">
                        <th>Title</th>
                        <th>Bond Actor</th>
                        <th>Bond Girl</th>
                        <th>Producer</th>
                        <th>Year</th>
                        <th>Length</th>
                    </tr>

                    <!-- Add only movies from Pierce Brosnan (sorted by name of Bond girl) -->

                    <xsl:apply-templates select="movie[starts-with(bond/text(), 'Pierce')]">
                        <xsl:sort select="bond_girl" data-type="text" order="descending"/>
                    </xsl:apply-templates>

                </table>

                <!-- Title and subtitle -->

                <div>
                    <br/>
                    <br/>
                    <b>Movies with Daniel Craig as main character in alphabetical order (by name of Bond girl in
                        ascending order):
                    </b>
                    <br/>
                    <br/>
                </div>

                <table border="1" cellpadding="10'">

                    <!-- Table header -->

                    <tr style="background-color:#F2F5A9">
                        <th>Title</th>
                        <th>Bond Actor</th>
                        <th>Bond Girl</th>
                        <th>Producer</th>
                        <th>Year</th>
                        <th>Length</th>
                    </tr>

                    <!-- Add only movies from Daniel Craig (sorted by name of Bond girl) -->

                    <xsl:apply-templates select="movie[starts-with(bond/text(), 'Daniel')]">
                        <xsl:sort select="bond_girl" data-type="text" order="ascending"/>
                    </xsl:apply-templates>

                </table>

            </body>
        </html>
    </xsl:template>

    <xsl:template match="movie">
        <tr>
            <td align="left">
                <xsl:value-of select="title"/>
            </td>
            <td align="left">
                <xsl:value-of select="bond"/>
            </td>
            <td align="left">
                <xsl:value-of select="bond_girl"/>
            </td>
            <td align="left">
                <xsl:value-of select="regie"/>
            </td>
            <td align="left">
                <xsl:value-of select="year"/>
            </td>
            <td align="center">
                <xsl:choose>
                    <xsl:when test="duration">
                        <xsl:value-of select="duration"/> min
                    </xsl:when>
                    <xsl:otherwise>
                        <i>unknown</i>
                    </xsl:otherwise>
                </xsl:choose>
            </td>
        </tr>
    </xsl:template>

</xsl:stylesheet>